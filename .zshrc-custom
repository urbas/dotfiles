export EDITOR=vim

export LC_CTYPE="en_GB.UTF-8"
export LANG="$LC_CTYPE"
export LANGUAGE="$LC_CTYPE"
export LC_ALL="$LC_CTYPE"

PROGRAMMING_DIR=$HOME/programming

# Nix
function nix-update-locale() {
  # This is a workaround for this problem: https://github.com/NixOS/nixpkgs/issues/38991
  export LOCALE_ARCHIVE_2_27="$(nix-build --no-out-link "<nixpkgs>" -A glibcLocales)/lib/locale/locale-archive"
}

if [ -f $HOME/.nix-profile/etc/profile.d/nix.sh ]; then
  . $HOME/.nix-profile/etc/profile.d/nix.sh
  alias nixup="nix-env -i homeEnv && nix-env --delete-generations old"
  nix-update-locale
fi

function nixupg() {
  nix-channel --update nixpkgs
  nix-env -u '*'
  nixup
  nix-update-locale
}

# Frequent directories aliases
alias n="cd $PROGRAMMING_DIR/nest"
alias p="cd $PROGRAMMING_DIR"

# General aliases
alias dotfiles="git --git-dir=$HOME/.my-dotfiles --work-tree=$HOME"
alias gaip="ga -ip"
alias c="xclip -selection clipboard"
alias v="xclip -selection clipboard -o"

function yqh() {
  if [ $# -gt 0 ]; then
    yq -y $@ | bat -l yaml
  else
    yq -y '.' | bat -l yaml
  fi
}

# Better cli
if [ -x "$(which bat)" ]; then
  alias cat="bat"
fi

export FZF_DEFAULT_COMMAND='fd --hidden --follow --exclude .git --exclude .cache'
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND --type f"
export FZF_ALT_C_COMMAND="$FZF_DEFAULT_COMMAND --type d"

if [ -f $HOME/.nix-profile/share/fzf/key-bindings.zsh ]; then
  . $HOME/.nix-profile/share/fzf/key-bindings.zsh
fi

# pyenv
export PYENV_ROOT="$HOME/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"
if command -v pyenv 1>/dev/null 2>&1; then
  eval "$(pyenv init -)"
fi

# nvm
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"